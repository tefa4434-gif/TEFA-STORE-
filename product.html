<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ | TEFA STORE</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 font-sans">

<header class="bg-white shadow sticky top-0 z-20">
  <div class="max-w-3xl mx-auto px-4 py-3 flex items-center justify-between">
    <button onclick="history.back()" class="text-sm text-gray-600 flex items-center gap-1">
      âŸµ Ø±Ø¬ÙˆØ¹
    </button>
    <h1 class="font-bold text-lg">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬</h1>
    <a href="cart.html" class="relative">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7" fill="none" viewBox="0 0 24 24"
           stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6"
              d="M3 3h2l.4 2M7 13h11l2-7H6.4M7 13L5.4 5M7 13l-2 7m5-7v7m4-7v7m4-7l2 7"/>
      </svg>
      <span
        class="cart-count hidden absolute -top-2 -left-2 bg-red-600 text-white text-[10px] leading-none rounded-full w-5 h-5 flex items-center justify-center">
        0
      </span>
    </a>
  </div>
</header>

<main class="max-w-3xl mx-auto px-4 py-4">
  <div id="productContainer" class="bg-white rounded-3xl shadow overflow-hidden">
    <!-- ÙŠØªÙ… Ù…Ù„Ø¤Ù‡ Ù…Ù† Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
  </div>
</main>

<script>
  const CART_KEY = 'tefaCart';

  const PRODUCTS = {
    rozalin: {
      id: 'rozalin',
      name: 'Ø·Ù‚Ù… Ø±ÙˆØ²Ø§Ù„ÙŠÙ† 3 Ù‚Ø·Ø¹',
      price: 749,
      oldPrice: 999,
      mainImage: 'rozalin-main.jpg',
      description: 'Ø§Ù„Ø®Ø§Ù…Ø© Ø±ÙˆØ²Ø§Ù„ÙŠÙ† Ù…Ø³ØªÙˆØ±Ø¯ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø©ØŒ ÙˆØ§Ù† Ø³Ø§ÙŠØ² ØªÙ„Ø¨ÙŠØ³ Ù…Ù† 60 Ù„Ù€ 95 ÙƒÙŠÙ„Ùˆ.',
      colors: [
        { key: 'simon', name: 'Ø³ÙŠÙ…ÙˆÙ†', hex: '#f9a8d4', image: 'rozalin-simon.jpg' },
        { key: 'black', name: 'Ø£Ø³ÙˆØ¯', hex: '#000000', image: 'rozalin-black.jpg' },
        { key: 'zyti', name: 'Ø²ÙŠØªÙŠ', hex: '#16a34a', image: 'rozalin-zyti.jpg' },
        { key: 'beige', name: 'Ø¨ÙŠØ¬', hex: '#f5e7c6', image: 'rozalin-beige.jpg' },
        { key: 'kafeh', name: 'ÙƒØ§ÙÙŠÙ‡', hex: '#b28b67', image: 'rozalin-kafeh.jpg' },
        { key: 'mov', name: 'Ù…ÙˆÙ', hex: '#7c3aed', image: 'rozalin-mov.jpg' }
      ]
    },
    formal: {
      id: 'formal',
      name: 'Ø·Ù‚Ù… ÙÙˆØ±Ù…Ø§Ù„ 3 Ù‚Ø·Ø¹',
      price: 699,
      oldPrice: 949,
      mainImage: 'formal-main.jpg',
      description: 'Ø§Ù„Ø®Ø§Ù…Ø© Ø±ÙˆØ²Ø§Ù„ÙŠÙ† â€“ ÙˆØ§Ù† Ø³Ø§ÙŠØ² ØªÙ„Ø¨ÙŠØ³ Ù…Ù† 65 Ù„Ù€ 85 ÙƒÙŠÙ„Ùˆ.',
      colors: [
        { key: 'ment', name: 'Ù…Ù†Øª', hex: '#22c55e', image: 'formal-ment.jpg' },
        { key: 'babyblue', name: 'Ø¨ÙŠØ¨ÙŠ Ø¨Ù„Ùˆ', hex: '#93c5fd', image: 'formal-babyblue.jpg' },
        { key: 'beige', name: 'Ø¨ÙŠØ¬', hex: '#f5e7c6', image: 'formal-beige.jpg' },
        { key: 'havan', name: 'Ù‡Ø§ÙØ§Ù†', hex: '#b45309', image: 'formal-havan.jpg' },
        { key: 'black', name: 'Ø£Ø³ÙˆØ¯', hex: '#000000', image: 'formal-black.jpg' }
      ]
    },
    abaya: {
      id: 'abaya',
      name: 'Ø¹Ø¨Ø§ÙŠØ© Ø²Ø±Ø§ÙŠØ± ÙƒØ¨Ø³',
      price: 749,
      oldPrice: 1049,
      mainImage: 'abaya-main.jpg',
      description: 'Ø¬ÙˆØ® Ù„ÙŠÙƒØ±Ø§ Ù…Ø³ØªÙˆØ±Ø¯ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø©ØŒ ÙˆØ§Ù† Ø³Ø§ÙŠØ² ØªÙ„Ø¨ÙŠØ³ Ù„Ø­Ø¯ 80 ÙƒÙŠÙ„Ùˆ.',
      colors: [
        { key: 'black', name: 'Ø£Ø³ÙˆØ¯', hex: '#000000', image: 'abaya-black.jpg' },
        { key: 'green', name: 'Ø²ÙŠØªÙŠ', hex: '#166534', image: 'abaya-green.jpg' },
        { key: 'darkgray', name: 'Ø±Ù…Ø§Ø¯ÙŠ ØºØ§Ù…Ù‚', hex: '#4b5563', image: 'abaya-darkgray.jpg' },
        { key: 'caramel', name: 'ÙƒØ±Ø§Ù…ÙŠÙ„', hex: '#b45309', image: 'abaya-caramel.jpg' },
        { key: 'burgundy', name: 'Ù†Ø¨ÙŠØªÙŠ', hex: '#7f1d1d', image: 'abaya-burgundy.jpg' },
        { key: 'lightgray', name: 'Ø±Ù…Ø§Ø¯ÙŠ ÙØ§ØªØ­', hex: '#e5e7eb', image: 'abaya-lightgray.jpg' }
      ]
    },
    toonz: {
      id: 'toonz',
      name: 'ØªÙˆÙ†Ø² Ù‚Ø·Ø¹ØªÙŠÙ†',
      price: 799,
      oldPrice: 1199,
      mainImage: 'toonz-main.jpg',
      description: 'Ø§Ù„Ø®Ø§Ù…Ø© Ø´Ù…ÙˆØ§Ù‡ ÙÙŠ Ø´Ù…ÙˆØ§Ù‡ â€“ Ø§Ù„Ø³Ø§ÙŠØ² Ù…Ù† 60 Ù„Ù€ 90 ÙƒÙŠÙ„Ùˆ Ù…Ø±ØªØ§Ø­.',
      colors: [
        { key: 'beige', name: 'Ø¨ÙŠØ¬', hex: '#f5e7c6', image: 'toonz-beige.jpg' },
        { key: 'olive', name: 'Ø²ÙŠØªÙŠ', hex: '#4d7c0f', image: 'toonz-olive.jpg' },
        { key: 'pink', name: 'Ø¨ÙŠÙ†Ùƒ', hex: '#f472b6', image: 'toonz-pink.jpg' },
        { key: 'purple', name: 'Ù…ÙˆÙ', hex: '#7c3aed', image: 'toonz-purple.jpg' },
        { key: 'wine', name: 'Ù†Ø¨ÙŠØªÙŠ', hex: '#7f1d1d', image: 'toonz-wine.jpg' }
      ]
    }
  };

  function loadCart() {
    const raw = localStorage.getItem(CART_KEY);
    try { return raw ? JSON.parse(raw) : []; } catch { return []; }
  }

  function saveCart(cart) {
    localStorage.setItem(CART_KEY, JSON.stringify(cart));
    updateCartBadge(cart);
  }

  function updateCartBadge(cart) {
    if (!cart) cart = loadCart();
    const count = cart.reduce((s, i) => s + (i.quantity || 0), 0);
    document.querySelectorAll('.cart-count').forEach(el => {
      if (count > 0) {
        el.textContent = count;
        el.classList.remove('hidden');
      } else {
        el.classList.add('hidden');
      }
    });
  }

  function getProductIdFromUrl() {
    const params = new URLSearchParams(window.location.search);
    return params.get('id');
  }

  function renderProduct() {
    const id = getProductIdFromUrl();
    const product = PRODUCTS[id];
    const container = document.getElementById('productContainer');

    if (!product) {
      container.innerHTML = '<div class="p-6 text-center text-gray-600">Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯.</div>';
      return;
    }

    let colorsHtml = '';
    product.colors.forEach((c, idx) => {
      colorsHtml += `
        <button
          type="button"
          class="color-btn w-11 h-11 rounded-full border-2 border-transparent flex items-center justify-center"
          data-color-key="${c.key}"
          data-color-name="${c.name}"
          data-image="${c.image}"
        >
          <span class="w-8 h-8 rounded-full" style="background:${c.hex}"></span>
        </button>
      `;
    });

    container.innerHTML = `
      <img id="productImage" src="${product.mainImage}" alt="${product.name}"
           class="w-full h-80 object-cover">
      <div class="p-5">
        <h2 class="text-xl md:text-2xl font-extrabold mb-1">${product.name}</h2>
        <p class="text-pink-600 font-bold text-2xl mb-1">
          ${product.price} Ø¬
          <span class="text-sm text-gray-500 line-through mr-1">${product.oldPrice} Ø¬</span>
        </p>
        <p class="text-gray-700 text-sm md:text-base mb-4">
          ${product.description}
        </p>

        <div class="mb-4">
          <p class="mb-2 font-semibold text-sm md:text-base">Ø§Ø®ØªØ§Ø±ÙŠ Ø§Ù„Ù„ÙˆÙ†</p>
          <div class="flex flex-wrap gap-3">
            ${colorsHtml}
          </div>
          <p id="selectedColorLabel" class="text-xs text-gray-600 mt-2">Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù„ÙˆÙ† Ø¨Ø¹Ø¯</p>
        </div>

        <div class="mb-4">
          <p class="mb-2 font-semibold text-sm md:text-base">Ø§Ù„ÙƒÙ…ÙŠØ©</p>
          <div class="flex items-center gap-4">
            <button id="minusBtn"
                    class="w-9 h-9 rounded-full border flex items-center justify-center text-xl">-</button>
            <span id="qtyDisplay" class="text-lg font-bold">1</span>
            <button id="plusBtn"
                    class="w-9 h-9 rounded-full border flex items-center justify-center text-xl">+</button>
          </div>
        </div>

        <button id="addToCartBtn"
          class="bg-black text-white w-full rounded-2xl py-3 text-base font-semibold">
          Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©
        </button>

        <p class="mt-3 text-xs text-gray-500 leading-relaxed">
          Ø§Ù„Ø´Ø­Ù†: 60 Ø¬ Ù„Ù„Ù‚Ø§Ù‡Ø±Ø© ÙˆØ§Ù„Ø¬ÙŠØ²Ø© â€“ 70 Ø¬ Ù„Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª (Ù…Ø§Ø¹Ø¯Ø§ Ø´Ø±Ù… Ø§Ù„Ø´ÙŠØ®ØŒ Ø§Ù„ØºØ±Ø¯Ù‚Ø©ØŒ
          Ù…Ø±Ø³Ù‰ Ù…Ø·Ø±ÙˆØ­ØŒ Ø´Ù…Ø§Ù„ Ø³ÙŠÙ†Ø§Ø¡ØŒ Ø¬Ù†ÙˆØ¨ Ø³ÙŠÙ†Ø§Ø¡ØŒ Ø§Ù„ÙˆØ§Ø¯ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯ 120 Ø¬).
        </p>
      </div>
    `;

    // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
    let selectedColor = null;
    let selectedColorName = '';
    const imageEl = document.getElementById('productImage');
    const colorBtns = container.querySelectorAll('.color-btn');
    const colorLabel = document.getElementById('selectedColorLabel');

    colorBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        colorBtns.forEach(b => b.classList.remove('ring-2', 'ring-black'));
        btn.classList.add('ring-2', 'ring-black');
        selectedColor = btn.dataset.colorKey;
        selectedColorName = btn.dataset.colorName;
        colorLabel.textContent = 'Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ù…Ø®ØªØ§Ø±: ' + selectedColorName;
        const img = btn.dataset.image;
        if (img) imageEl.src = img;
      });
    });

    let qty = 1;
    const qtyDisplay = document.getElementById('qtyDisplay');
    document.getElementById('plusBtn').onclick = () => {
      qty++;
      qtyDisplay.textContent = qty;
    };
    document.getElementById('minusBtn').onclick = () => {
      if (qty > 1) qty--;
      qtyDisplay.textContent = qty;
    };

    document.getElementById('addToCartBtn').onclick = () => {
      if (!selectedColor) {
        alert('Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ø®ØªØ§Ø±ÙŠ Ù„ÙˆÙ† Ø§Ù„Ø£ÙˆÙ„ ğŸ˜Š');
        return;
      }
      const cart = loadCart();
      const existing = cart.find(item =>
        item.productId === product.id && item.color === selectedColor
      );
      if (existing) {
        existing.quantity += qty;
      } else {
        cart.push({
          productId: product.id,
          name: product.name,
          price: product.price,
          color: selectedColor,
          colorName: selectedColorName,
          quantity: qty
        });
      }
      saveCart(cart);
      alert('ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù„ÙˆÙ† Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­ ğŸ¥°');
    };
  }

  document.addEventListener('DOMContentLoaded', () => {
    updateCartBadge();
    renderProduct();
  });
</script>

</body>
</html>