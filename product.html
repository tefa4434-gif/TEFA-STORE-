<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£Ù„ÙˆØ§Ù† - TEFA STORE</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f3f3f3;
      color: #111;
      line-height: 1.6;
    }
    a { text-decoration: none; color: inherit; }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 16px;
    }

    header {
      background: #f3f3f3;
      padding: 12px 16px;
      border-bottom: 1px solid #ddd;
    }
    .header-inner {
      max-width: 900px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }
    .store-name {
      font-size: 20px;
      font-weight: 800;
    }
    .store-sub {
      font-size: 12px;
      color: #555;
    }

    .cart-icon-wrapper {
      position: relative;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      border-radius: 999px;
      background: #111;
      color: #fff;
    }
    .cart-badge {
      position: absolute;
      top: -4px;
      left: -4px;
      min-width: 18px;
      height: 18px;
      padding: 0 4px;
      border-radius: 999px;
      background: #ff3b30;
      color: #fff;
      font-size: 11px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
    }

    /* Product layout */
    .product-page {
      margin-top: 12px;
      background: #ffffff;
      border-radius: 18px;
      padding: 14px 14px 18px;
      box-shadow: 0 8px 18px rgba(0,0,0,0.06);
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
    }
    @media (min-width: 720px) {
      .product-page {
        grid-template-columns: minmax(0, 1.05fr) minmax(0, 1fr);
      }
    }

    .product-image-wrapper {
      border-radius: 16px;
      overflow: hidden;
      background: #e5e5e5;
      display: flex;
      align-items: center;
      justify-content: center;
      max-height: 420px;
    }
    .product-image-wrapper img {
      width: 100%;
      height: 100%;
      max-height: 420px;
      object-fit: cover;
      display: block;
    }

    .product-info-title {
      font-size: 20px;
      font-weight: 800;
      margin-bottom: 4px;
    }
    .product-info-sub {
      font-size: 13px;
      color: #555;
      margin-bottom: 6px;
    }
    .product-info-line {
      font-size: 13px;
      color: #444;
    }

    .product-price-row {
      margin-top: 8px;
      display: flex;
      align-items: baseline;
      gap: 6px;
      font-size: 14px;
    }
    .product-price {
      font-size: 20px;
      font-weight: 900;
      color: #16a34a;
    }
    .product-oldprice {
      font-size: 12px;
      color: #9ca3af;
      text-decoration: line-through;
    }

    .colors-label {
      margin-top: 14px;
      font-size: 14px;
      font-weight: 700;
    }
    .colors-row {
      margin-top: 8px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .color-dot {
      width: 34px;
      height: 34px;
      border-radius: 999px;
      border: 2px solid transparent;
      cursor: pointer;
      box-shadow: 0 0 0 1px rgba(0,0,0,0.06);
      transition: transform 0.1s ease, box-shadow 0.1s ease, border-color 0.1s ease, opacity 0.1s ease;
    }
    .color-dot:hover {
      transform: scale(1.05);
    }
    .color-dot.selected {
      border-color: #111;
      box-shadow: 0 0 0 2px #1113;
    }
    .color-dot.disabled {
      opacity: 0.25;
      cursor: not-allowed;
    }

    .selected-color-text {
      margin-top: 6px;
      font-size: 13px;
      color: #333;
    }

    .qty-row {
      margin-top: 16px;
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 14px;
    }
    .qty-controls {
      display: inline-flex;
      align-items: center;
      border-radius: 999px;
      border: 1px solid #ddd;
      overflow: hidden;
    }
    .qty-btn {
      width: 32px;
      height: 32px;
      border: none;
      background: #f3f3f3;
      font-size: 18px;
      cursor: pointer;
    }
    .qty-value {
      min-width: 32px;
      text-align: center;
      font-weight: 600;
      font-size: 15px;
    }

    .btn {
      border: none;
      cursor: pointer;
      border-radius: 999px;
      font-weight: 600;
      padding: 10px 16px;
      font-size: 14px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }
    .btn-primary {
      background: #111;
      color: #fff;
      width: 100%;
      margin-top: 16px;
    }
    .btn-secondary {
      background: #fff;
      color: #111;
      border: 1px solid #ddd;
      width: 100%;
      margin-top: 8px;
      text-align: center;
    }

    .note {
      margin-top: 8px;
      font-size: 12px;
      color: #666;
    }

    .toast {
      position: fixed;
      bottom: 16px;
      right: 16px;
      background: #111;
      color: #fff;
      padding: 10px 14px;
      border-radius: 999px;
      font-size: 13px;
      display: none;
      align-items: center;
      gap: 6px;
      z-index: 50;
      box-shadow: 0 10px 25px rgba(0,0,0,0.15);
      max-width: 260px;
    }
  </style>
</head>
<body>
  <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
  <header>
    <div class="header-inner">
      <div>
        <div class="store-name">TEFA STORE</div>
        <div class="store-sub">Ø§Ø®ØªØ§Ø±ÙŠ Ø§Ù„Ù„ÙˆÙ† ÙˆØ§Ù„ÙƒÙ…ÙŠØ© ÙˆØ¨Ø¹Ø¯ÙŠÙ† ÙƒÙ…Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨ Ù…Ù† Ø§Ù„Ø³Ù„Ø©</div>
      </div>
      <a href="cart.html" class="cart-icon-wrapper" aria-label="Ø³Ù„Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª">
        <span>ğŸ›’</span>
        <div class="cart-badge" id="cart-count">0</div>
      </a>
    </div>
  </header>

  <main class="container">
    <section class="product-page">
      <div class="product-image-wrapper">
        <img id="product-image" src="" alt="ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…Ø®ØªØ§Ø±">
      </div>

      <div>
        <h1 class="product-info-title" id="product-name">Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬</h1>
        <p class="product-info-sub" id="product-desc"></p>
        <p class="product-info-line" id="product-extra"></p>

        <div class="product-price-row">
          <span class="product-price" id="product-price"></span>
          <span class="product-oldprice" id="product-oldprice"></span>
        </div>

        <div class="colors-label">Ø§Ø®ØªØ§Ø±ÙŠ Ø§Ù„Ù„ÙˆÙ† (Ø¯ÙˆØ§Ø¦Ø± Ø£Ù„ÙˆØ§Ù†):</div>
        <div class="colors-row" id="colors-row"></div>
        <div class="selected-color-text" id="selected-color-text">Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù„ÙˆÙ† Ø¨Ø¹Ø¯.</div>

        <div class="qty-row">
          <span>Ø§Ù„ÙƒÙ…ÙŠØ©:</span>
          <div class="qty-controls">
            <button type="button" class="qty-btn" id="qty-minus">âˆ’</button>
            <div class="qty-value" id="qty-value">1</div>
            <button type="button" class="qty-btn" id="qty-plus">+</button>
          </div>
        </div>

        <button class="btn btn-primary" id="add-to-cart-btn">
          Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©
        </button>
        <a href="cart.html" class="btn btn-secondary">
          Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ù…Ù† Ø§Ù„Ø³Ù„Ø©
        </a>

        <p class="note">
          ØªÙ‚Ø¯Ø±ÙŠ ØªØ¶ÙŠÙÙŠ ÙƒÙ„ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù„ÙŠ Ø¹Ø§ÙŠØ²Ø§Ù‡Ø§ Ù„Ù†ÙØ³ Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„ØŒ ÙˆØ¨Ø¹Ø¯Ù‡Ø§ Ù…Ù† ØµÙØ­Ø© Ø§Ù„Ø³Ù„Ø© ØªØ¯Ø®Ù„ÙŠ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ ÙˆØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø£ÙˆØ±Ø¯Ø± âœ¨
        </p>
      </div>
    </section>
  </main>

  <div class="toast" id="toast">ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù„ÙˆÙ† Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­ ğŸ¥°</div>

  <!-- ØµÙˆØª Ø¨Ø³ÙŠØ· Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ© (Ø­Ø·ÙŠ Ù…Ù„Ù notify.mp3 Ø¬Ù†Ø¨ Ø§Ù„ØµÙØ­Ø©) -->
  <audio id="add-sound">
    <source src="notify.mp3" type="audio/mpeg">
  </audio>

  <script>
    const CART_KEY = 'tefa_cart';
    const COLOR_STATUS_KEY = 'tefa_color_status_v1'; // Ù†ÙØ³ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ù„ÙŠ ÙÙŠ admin

    function getCart() {
      try {
        return JSON.parse(localStorage.getItem(CART_KEY)) || [];
      } catch (e) {
        return [];
      }
    }

    function saveCart(cart) {
      localStorage.setItem(CART_KEY, JSON.stringify(cart));
      updateCartCount();
    }

    function updateCartCount() {
      const cart = getCart();
      const count = cart.reduce((sum, item) => sum + (item.qty || 0), 0);
      const badge = document.getElementById('cart-count');
      if (!badge) return;
      badge.textContent = count;
      badge.style.visibility = count > 0 ? 'visible' : 'hidden';
    }

    function loadColorStatus() {
      try {
        return JSON.parse(localStorage.getItem(COLOR_STATUS_KEY)) || {};
      } catch (e) {
        return {};
      }
    }

    // ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù†
    const PRODUCTS = {
      rozalin: {
        key: 'rozalin',
        code: 'CD05',
        name: 'Ø¯Ø±ÙŠØ³ Ù‚Ø·Ø¹ØªÙŠÙ† Ø¨Ø§Ù„Ø¨Ø·Ùˆ Ø¬ÙˆØ®',
        desc: 'Ø¨ÙŠØ²Ùƒ Ø±ÙŠØ¨ Ù…Ø¹ Ø¨Ø§Ù„Ø·Ùˆ Ø¬ÙˆØ® Ù„ÙŠÙƒØ±Ø§ Ù…Ø³ØªÙˆØ±Ø¯ â€“ ÙˆÙ† Ø³Ø§ÙŠØ² ØªÙ„Ø¨ÙŠØ³ Ù„Ø­Ø¯ 85 Ùƒ ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹.',
        extra: 'Ø£Ù„ÙˆØ§Ù†: Ø±ÙˆØ² â€“ Ø£ÙˆÙ ÙˆØ§ÙŠØª â€“ Ø¨Ù†ÙŠ â€“ Ù‡Ø§ÙØ§Ù† â€“ Ø£Ø³ÙˆØ¯ â€“ Ø²ÙŠØªÙŠ.',
        price: 849,
        oldPrice: 1049,
        mainImage: 'coatdress-main.jpg',
        colors: [
          { key: 'rose',    label: 'Ø±ÙˆØ²',       hex: '#c47b7f', image: 'coatdress-rose.jpg' },
          { key: 'offwhite',label: 'Ø£ÙˆÙ ÙˆØ§ÙŠØª', hex: '#f3eadf', image: 'coatdress-offwhite.jpg' },
          { key: 'brown',   label: 'Ø¨Ù†ÙŠ',       hex: '#5d4031', image: 'coatdress-brown.jpg' },
          { key: 'havan',   label: 'Ù‡Ø§ÙØ§Ù†',     hex: '#8b5a2b', image: 'coatdress-havan.jpg' },
          { key: 'black',   label: 'Ø£Ø³ÙˆØ¯',      hex: '#111111', image: 'coatdress-black.jpg' },
          { key: 'olive',   label: 'Ø²ÙŠØªÙŠ',      hex: '#3f5f3a', image: 'coatdress-olive.jpg' }
        ]
      },
      formal: {
        key: 'formal',
        code: 'VG06',
        name: 'ÙƒÙˆÙ„ÙŠÙƒØ´Ù† Ø¯Ø±Ø³Ø§Øª Ù‚Ø·ÙŠÙØ© Ù…Ø¶Ù„Ø¹ â€“ ÙƒÙˆÙ„ÙŠÙƒØ´Ù† Ù…Ø­Ø¬Ø¨Ø§Øª',
        desc: 'ØªØ£Ù„Ù‚ÙŠ Ø¨Ø£Ø­Ø¯Ø« ÙƒÙˆÙ„ÙŠÙƒØ´Ù† Ù…Ø­Ø¬Ø¨Ø§Øª Ø®Ø§Ù…Ø© Ù‚Ø·ÙŠÙØ© Ù…Ø¶Ù„Ø¹ Ù…Ø³ØªÙˆØ±Ø¯Ø©.',
        extra: 'Ø§Ù„Ù…Ù‚Ø§Ø³: Ù…Ù† 65 Ù„Ù€ 85 ÙƒÙŠÙ„Ùˆ ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹.',
        price: 649,
        oldPrice: 949,
        mainImage: 'velvetset-main.jpg',
        // ÙƒØ­Ù„ÙŠ â€“ Ø²ÙŠØªÙŠ â€“ Ø¨ÙŠØ¬ â€“ Ø£Ø³ÙˆØ¯ â€“ Ø£ÙˆÙ ÙˆØ§ÙŠØª (Ø´ÙŠÙ„Ù†Ø§ Ù†Ø¨ÙŠØªÙŠ)
        colors: [
          { key: 'kahli',   label: 'ÙƒØ­Ù„ÙŠ',      hex: '#0f172a', image: 'velvetset-kahli.jpg' },
          { key: 'olive',   label: 'Ø²ÙŠØªÙŠ',      hex: '#3f5f3a', image: 'velvetset-olive.jpg' },
          { key: 'beige',   label: 'Ø¨ÙŠØ¬',       hex: '#e3c8a3', image: 'velvetset-beige.jpg' },
          { key: 'black',   label: 'Ø£Ø³ÙˆØ¯',      hex: '#111111', image: 'velvetset-black.jpg' },
          { key: 'offwhite',label: 'Ø£ÙˆÙ ÙˆØ§ÙŠØª', hex: '#f3eadf', image: 'velvetset-offwhite.jpg' }
        ]
      },
      abaya: {
        key: 'abaya',
        code: 'ZC07',
        name: 'Ø¯Ø±ÙŠØ³ Ø³ÙˆØ³ØªØ© ÙƒØ§Ø¨ÙŠØ´Ùˆ ÙØ±Ùˆ',
        desc: 'Ø¬ÙˆØ® Ù„ÙŠÙƒØ±Ø§ Ù…Ø³ØªÙˆØ±Ø¯ Ù…Ø¹ ÙƒØ§Ø¨ÙŠØ´Ùˆ ÙØ±Ùˆ Ù†Ø§Ø¹Ù… â€“ ÙˆÙ† Ø³Ø§ÙŠØ² ØªÙ„Ø¨ÙŠØ³ Ù„Ø­Ø¯ 85 Ùƒ ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹.',
        extra: 'Ø£Ù„ÙˆØ§Ù†: Ø¬Ù…Ù„ÙŠ â€“ Ø²ÙŠØªÙŠ â€“ Ø¨ÙŠØ¬ â€“ Ù†Ø¨ÙŠØªÙŠ â€“ Ø£Ø³ÙˆØ¯.',
        price: 649,
        oldPrice: 849,
        mainImage: 'ziphoodie-main.jpg',
        colors: [
          { key: 'camel',  label: 'Ø¬Ù…Ù„ÙŠ',  hex: '#b98a55', image: 'ziphoodie-brown.jpg' },
          { key: 'olive',  label: 'Ø²ÙŠØªÙŠ',  hex: '#3f5f3a', image: 'ziphoodie-olive.jpg' },
          { key: 'beige',  label: 'Ø¨ÙŠØ¬',   hex: '#e3c8a3', image: 'ziphoodie-beige.jpg' },
          { key: 'maroon', label: 'Ù†Ø¨ÙŠØªÙŠ', hex: '#7f1d1d', image: 'ziphoodie-maroon.jpg' },
          { key: 'black',  label: 'Ø£Ø³ÙˆØ¯',  hex: '#111111', image: 'ziphoodie-black.jpg' }
        ]
      },
      toonz: {
        key: 'toonz',
        code: 'BD08',
        name: 'Ø¯Ø±ÙŠØ³ Ø³Ø§Ø¯Ø© ÙƒÙ… Ø¨Ù„ÙˆÙ†Ø© Ù…Ø¹ Ø­Ø²Ø§Ù…',
        desc: 'Ø¯Ø±ÙŠØ³ Ø´ÙŠÙƒ Ø¨Ø³ÙˆØ³ØªØ© Ù…Ù† Ø§Ù„Ø®Ù„Ù Ø¨Ø­Ø²Ø§Ù… Ø´ÙØ§Ù ÙˆÙƒÙ… Ø¨Ù„ÙˆÙ†Ø©ØŒ Ø®Ø§Ù…Ø© Ù‚Ø·ÙŠÙØ© Ù…Ø¶Ù„Ø¹ Ù…Ø³ØªÙˆØ±Ø¯Ø©.',
        extra: 'Ø§Ù„Ù…Ù‚Ø§Ø³: ÙˆÙ† Ø³Ø§ÙŠØ² Ù„Ø­Ø¯ 85 Ùƒ ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹.',
        price: 599,
        oldPrice: 799,
        mainImage: 'beltdress-main.jpg',
        colors: [
          { key: 'olive',  label: 'Ø²ÙŠØªÙŠ',  hex: '#3f5f3a', image: 'beltdress-olive.jpg' },
          { key: 'blue',   label: 'Ù†Ø¨ÙŠØªÙŠ', hex: '#1d3b70', image: 'beltdress-blue.jpg' },
          { key: 'camel',  label: 'Ø¬Ù…Ù„ÙŠ',  hex: '#c79a57', image: 'beltdress-camel.jpg' },
          { key: 'beige',  label: 'Ø¨ÙŠØ¬',   hex: '#e3c8a3', image: 'beltdress-beige.jpg' },
          { key: 'maroon', label: 'Ù†Ø¨ÙŠØªÙŠ ØºØ§Ù…Ù‚', hex: '#7f1d1d', image: 'beltdress-maroon.jpg' },
          { key: 'black',  label: 'Ø£Ø³ÙˆØ¯',  hex: '#111111', image: 'beltdress-black.jpg' }
        ]
      }
    };

    function getQueryParam(name) {
      const params = new URLSearchParams(window.location.search);
      return params.get(name);
    }

    function showToast(message, colorHex) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      if (colorHex) {
        toast.style.background = colorHex;
        toast.style.color = '#fff';
      } else {
        toast.style.background = '#111';
        toast.style.color = '#fff';
      }
      toast.style.display = 'flex';
      setTimeout(() => {
        toast.style.display = 'none';
      }, 1800);
    }

    document.addEventListener('DOMContentLoaded', () => {
      const productKey = getQueryParam('product') || 'rozalin';
      const product = PRODUCTS[productKey] || PRODUCTS['rozalin'];

      const imgEl = document.getElementById('product-image');
      const nameEl = document.getElementById('product-name');
      const descEl = document.getElementById('product-desc');
      const extraEl = document.getElementById('product-extra');
      const priceEl = document.getElementById('product-price');
      const oldPriceEl = document.getElementById('product-oldprice');
      const colorsRow = document.getElementById('colors-row');
      const selectedColorText = document.getElementById('selected-color-text');

      nameEl.textContent = product.name;
      descEl.textContent = product.desc;
      extraEl.textContent = product.extra;
      priceEl.textContent = product.price + ' Ø¬';
      oldPriceEl.textContent = product.oldPrice + ' Ø¬';
      imgEl.src = product.mainImage;

      let selectedColorKey = null;
      let selectedColorObj = null;

      // Ø­Ø§Ù„Ø© Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
      const colorStatusMap = loadColorStatus();
      const productStatus = colorStatusMap[product.key] || {};

      // Ø±Ø³Ù… Ø¯ÙˆØ§Ø¦Ø± Ø§Ù„Ø£Ù„ÙˆØ§Ù†
      product.colors.forEach(color => {
        // Ù„Ùˆ Ø§Ù„Ù„ÙˆÙ† Ù…ØªØ³Ø¬Ù„ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ùˆ Ù…ØªØ¹Ù„Ù‘Ù… Ø¹Ù„ÙŠÙ‡ "Ù…Ù‚ÙÙˆÙ„" (false) ÙŠØ¨Ù‚Ù‰ Ù…Ù‚ÙÙˆÙ„
        let enabled = true;
        if (Object.prototype.hasOwnProperty.call(productStatus, color.label)) {
          enabled = !!productStatus[color.label];
        }

        const dot = document.createElement('button');
        dot.type = 'button';
        dot.className = 'color-dot';
        dot.style.backgroundColor = color.hex;
        dot.setAttribute('aria-label', color.label);

        if (!enabled) {
          dot.classList.add('disabled');
        } else {
          dot.addEventListener('click', () => {
            document.querySelectorAll('.color-dot').forEach(d => d.classList.remove('selected'));
            dot.classList.add('selected');
            selectedColorKey = color.key;
            selectedColorObj = color;
            selectedColorText.textContent = 'Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ù…Ø®ØªØ§Ø±: ' + color.label;
            imgEl.src = color.image || product.mainImage;
          });
        }

        colorsRow.appendChild(dot);
      });

      // ÙƒÙ…ÙŠØ©
      const qtyValueEl = document.getElementById('qty-value');
      document.getElementById('qty-plus').addEventListener('click', () => {
        let v = parseInt(qtyValueEl.textContent, 10) || 1;
        if (v < 20) v++;
        qtyValueEl.textContent = v;
      });
      document.getElementById('qty-minus').addEventListener('click', () => {
        let v = parseInt(qtyValueEl.textContent, 10) || 1;
        if (v > 1) v--;
        qtyValueEl.textContent = v;
      });

      // Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©
      document.getElementById('add-to-cart-btn').addEventListener('click', () => {
        if (!selectedColorObj) {
          alert('Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ø®ØªØ§Ø±ÙŠ Ù„ÙˆÙ† Ø§Ù„Ø£ÙˆÙ„ ğŸ’œ');
          return;
        }
        const qty = parseInt(qtyValueEl.textContent, 10) || 1;

        const cart = getCart();

        const existing = cart.find(
          item => item.productKey === product.key && item.colorKey === selectedColorKey
        );

        if (existing) {
          existing.qty += qty;
        } else {
          cart.push({
            id: Date.now(),
            productKey: product.key,
            name: product.name,
            price: product.price,
            qty: qty,
            colorKey: selectedColorKey,
            colorName: selectedColorObj.label,
            colorLabel: selectedColorObj.label,
            colorText: selectedColorObj.label,
            colorHex: selectedColorObj.hex,
            color: selectedColorObj.hex,
            image: selectedColorObj.image || product.mainImage
          });
        }

        saveCart(cart);

        const sound = document.getElementById('add-sound');
        if (sound && sound.play) {
          try {
            sound.currentTime = 0;
            sound.play().catch(() => {});
          } catch (e) {}
        }

        showToast('ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù„ÙˆÙ† ' + selectedColorObj.label + ' Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­ ğŸ¥°', selectedColorObj.hex);
      });

      updateCartCount();
      window.addEventListener('storage', (e) => {
        if (e.key === CART_KEY) updateCartCount();
      });
    });
  </script>
</body>
</html>