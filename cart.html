<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Ø³Ù„Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª | TEFA STORE</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f5f5f7;
      color: #111827;
    }
    header {
      background: #000;
      color: #fff;
      padding: 14px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    header h1 {
      margin: 0;
      font-size: 18px;
    }
    .back-btn {
      background: none;
      border: none;
      color: #fff;
      font-size: 18px;
      cursor: pointer;
    }
    main {
      padding: 16px;
      max-width: 700px;
      margin: 0 auto;
    }
    .card {
      background: #fff;
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.04);
    }
    .card h2 {
      margin-top: 0;
      font-size: 18px;
    }
    .cart-items-empty {
      text-align: center;
      padding: 24px 8px;
      color: #6b7280;
      font-size: 14px;
    }
    .cart-item {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      padding: 10px 0;
      border-bottom: 1px solid #f3f4f6;
      gap: 8px;
    }
    .cart-item:last-child {
      border-bottom: none;
    }
    .cart-item-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 4px;
    }
    .cart-item-meta {
      font-size: 13px;
      color: #6b7280;
    }
    .cart-item-price {
      font-size: 14px;
      font-weight: 700;
      white-space: nowrap;
    }
    .remove-btn {
      border: none;
      background: #fee2e2;
      color: #b91c1c;
      border-radius: 999px;
      padding: 4px 10px;
      font-size: 12px;
      cursor: pointer;
      margin-top: 4px;
    }
    .summary-row {
      display: flex;
      justify-content: space-between;
      font-size: 14px;
      margin: 4px 0;
    }
    .summary-row strong {
      font-weight: 700;
    }
    .summary-row.total {
      margin-top: 8px;
      font-size: 16px;
    }
    label {
      display: block;
      font-size: 13px;
      margin-bottom: 4px;
      color: #374151;
    }
    input, select, textarea {
      width: 100%;
      box-sizing: border-box;
      border-radius: 10px;
      border: 1px solid #e5e7eb;
      padding: 10px 12px;
      font-size: 14px;
      outline: none;
      transition: border-color 0.15s, box-shadow 0.15s;
      background: #f9fafb;
    }
    input:focus, select:focus, textarea:focus {
      border-color: #111827;
      box-shadow: 0 0 0 1px #11182711;
      background: #fff;
    }
    textarea {
      min-height: 70px;
      resize: vertical;
    }
    .helper-text {
      font-size: 11px;
      color: #6b7280;
      margin-top: 4px;
    }
    .btn-primary {
      width: 100%;
      border: none;
      border-radius: 999px;
      padding: 14px;
      font-size: 16px;
      font-weight: 700;
      background: #000;
      color: #fff;
      cursor: pointer;
      margin-top: 16px;
    }
    .btn-primary:disabled {
      opacity: 0.6;
      cursor: progress;
    }
    .badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 22px;
      padding: 2px 6px;
      border-radius: 999px;
      background: #ef4444;
      color: #fff;
      font-size: 12px;
      margin-right: 4px;
    }
  </style>
</head>
<body>

<header>
  <button class="back-btn" onclick="window.history.back()">â†</button>
  <h1>Ø³Ù„Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h1>
  <span></span>
</header>

<main>
  <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³Ù„Ø© -->
  <section class="card" id="cartCard">
    <h2>Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø³Ù„Ø© <span class="badge" id="cartCount">0</span></h2>
    <div id="cartItemsContainer"></div>
  </section>

  <!-- Ù…Ù„Ø®Øµ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± -->
  <section class="card">
    <h2>Ù…Ù„Ø®Øµ Ø§Ù„Ø·Ù„Ø¨</h2>
    <div id="summaryRows">
      <div class="summary-row">
        <span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</span>
        <span id="productsTotalText">0 Ø¬</span>
      </div>
      <div class="summary-row">
        <span>ØªÙƒÙ„ÙØ© Ø§Ù„Ø´Ø­Ù†</span>
        <span id="shippingText">0 Ø¬</span>
      </div>
      <div class="summary-row total">
        <strong>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ø´Ø­Ù†</strong>
        <strong id="grandTotalText">0 Ø¬</strong>
      </div>
    </div>
  </section>

  <!-- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ -->
  <section class="card">
    <h2>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙˆØµÙŠÙ„</h2>
    <form id="orderForm">
      <div style="margin-bottom: 12px;">
        <label>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ *</label>
        <input type="text" id="name" required placeholder="Ù…Ø«Ø§Ù„: ÙØ§Ø·Ù…Ø© Ø£Ø­Ù…Ø¯" />
      </div>

      <div style="margin-bottom: 12px;">
        <label>Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ *</label>
        <input type="tel" id="phone" required placeholder="01xxxxxxxxx" />
        <div class="helper-text">ÙŠÙÙØ¶Ù‘Ù„ Ø±Ù‚Ù… Ø¹Ù„ÙŠÙ‡ ÙˆØ§ØªØ³Ø§Ø¨.</div>
      </div>

      <div style="margin-bottom: 12px;">
        <label>Ù…Ø­Ø§ÙØ¸Ø© Ø§Ù„ØªÙˆØµÙŠÙ„ *</label>
        <select id="governorate" required>
          <option value="">Ø§Ø®ØªØ§Ø±ÙŠ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</option>
          <option value="Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©">Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©</option>
          <option value="Ø§Ù„Ø¬ÙŠØ²Ø©">Ø§Ù„Ø¬ÙŠØ²Ø©</option>
          <!-- Ø´Ø­Ù† 70 Ø¬ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰ -->
          <option value="Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©">Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©</option>
          <option value="Ø§Ù„Ù‚Ù„ÙŠÙˆØ¨ÙŠØ©">Ø§Ù„Ù‚Ù„ÙŠÙˆØ¨ÙŠØ©</option>
          <option value="Ø§Ù„Ø´Ø±Ù‚ÙŠØ©">Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</option>
          <option value="Ø§Ù„Ø¯Ù‚Ù‡Ù„ÙŠØ©">Ø§Ù„Ø¯Ù‚Ù‡Ù„ÙŠØ©</option>
          <option value="Ø§Ù„ØºØ±Ø¨ÙŠØ©">Ø§Ù„ØºØ±Ø¨ÙŠØ©</option>
          <option value="Ø§Ù„Ù…Ù†ÙˆÙÙŠØ©">Ø§Ù„Ù…Ù†ÙˆÙÙŠØ©</option>
          <option value="Ø§Ù„Ø¨Ø­ÙŠØ±Ø©">Ø§Ù„Ø¨Ø­ÙŠØ±Ø©</option>
          <option value="ÙƒÙØ± Ø§Ù„Ø´ÙŠØ®">ÙƒÙØ± Ø§Ù„Ø´ÙŠØ®</option>
          <option value="Ø¯Ù…ÙŠØ§Ø·">Ø¯Ù…ÙŠØ§Ø·</option>
          <option value="Ø¨ÙˆØ±Ø³Ø¹ÙŠØ¯">Ø¨ÙˆØ±Ø³Ø¹ÙŠØ¯</option>
          <option value="Ø§Ù„Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ÙŠØ©">Ø§Ù„Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ÙŠØ©</option>
          <option value="Ø§Ù„Ø³ÙˆÙŠØ³">Ø§Ù„Ø³ÙˆÙŠØ³</option>
          <option value="Ø§Ù„ÙÙŠÙˆÙ…">Ø§Ù„ÙÙŠÙˆÙ…</option>
          <option value="Ø¨Ù†ÙŠ Ø³ÙˆÙŠÙ">Ø¨Ù†ÙŠ Ø³ÙˆÙŠÙ</option>
          <option value="Ø§Ù„Ù…Ù†ÙŠØ§">Ø§Ù„Ù…Ù†ÙŠØ§</option>
          <option value="Ø£Ø³ÙŠÙˆØ·">Ø£Ø³ÙŠÙˆØ·</option>
          <option value="Ø³ÙˆÙ‡Ø§Ø¬">Ø³ÙˆÙ‡Ø§Ø¬</option>
          <option value="Ù‚Ù†Ø§">Ù‚Ù†Ø§</option>
          <option value="Ø§Ù„Ø£Ù‚ØµØ±">Ø§Ù„Ø£Ù‚ØµØ±</option>
          <option value="Ø£Ø³ÙˆØ§Ù†">Ø£Ø³ÙˆØ§Ù†</option>
          <option value="Ø§Ù„Ø¨Ø­Ø± Ø§Ù„Ø£Ø­Ù…Ø±">Ø§Ù„Ø¨Ø­Ø± Ø§Ù„Ø£Ø­Ù…Ø±</option>
          <option value="Ù…Ø·Ø±ÙˆØ­">Ù…Ø·Ø±ÙˆØ­</option>
          <option value="Ø§Ù„ÙˆØ§Ø¯ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯">Ø§Ù„ÙˆØ§Ø¯ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯</option>
          <option value="Ø´Ù…Ø§Ù„ Ø³ÙŠÙ†Ø§Ø¡">Ø´Ù…Ø§Ù„ Ø³ÙŠÙ†Ø§Ø¡</option>
          <option value="Ø¬Ù†ÙˆØ¨ Ø³ÙŠÙ†Ø§Ø¡">Ø¬Ù†ÙˆØ¨ Ø³ÙŠÙ†Ø§Ø¡</option>
          <option value="Ø´Ø±Ù… Ø§Ù„Ø´ÙŠØ®">Ø´Ø±Ù… Ø§Ù„Ø´ÙŠØ®</option>
          <option value="Ø§Ù„ØºØ±Ø¯Ù‚Ø©">Ø§Ù„ØºØ±Ø¯Ù‚Ø©</option>
          <option value="Ù…Ø±Ø³Ù‰ Ù…Ø·Ø±ÙˆØ­">Ù…Ø±Ø³Ù‰ Ù…Ø·Ø±ÙˆØ­</option>
        </select>
        <div class="helper-text">Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© ÙˆØ§Ù„Ø¬ÙŠØ²Ø© Ø´Ø­Ù† 60 Ø¬ â€“ Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª 70 Ø¬ Ù…Ø§Ø¹Ø¯Ø§ Ø´Ø±Ù… Ø§Ù„Ø´ÙŠØ® / Ø§Ù„ØºØ±Ø¯Ù‚Ø© / Ù…Ø±Ø³Ù‰ Ù…Ø·Ø±ÙˆØ­ / Ø´Ù…Ø§Ù„ Ø³ÙŠÙ†Ø§Ø¡ / Ø¬Ù†ÙˆØ¨ Ø³ÙŠÙ†Ø§Ø¡ / Ø§Ù„ÙˆØ§Ø¯ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯: Ø´Ø­Ù† 120 Ø¬.</div>
      </div>

      <div style="margin-bottom: 12px;">
        <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„ØªÙØµÙŠÙ„ *</label>
        <textarea id="address" required placeholder="Ø§Ù„Ø´Ø§Ø±Ø¹ â€“ Ø±Ù‚Ù… Ø§Ù„Ø¨ÙŠØª â€“ Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ù…ÙŠØ²Ø©"></textarea>
      </div>

      <div style="margin-bottom: 12px;">
        <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø·Ù„Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
        <textarea id="notes" placeholder="Ù…Ù‚Ø§Ø³ ÙˆØ³Ø¹ Ø´ÙˆÙŠØ©ØŒ ÙŠÙÙØ¶Ù‘Ù„ Ø§ØªØµØ§Ù„ Ù‚Ø¨Ù„ Ø§Ù„Ø´Ø­Ù† .."></textarea>
      </div>

      <div style="margin-bottom: 4px;">
        <label>Ø§Ù„Ø·ÙˆÙ„ Ø£Ùˆ Ø§Ù„ÙˆØ²Ù† (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
        <input id="weight" placeholder="Ù…Ø«Ø§Ù„: 165 Ø³Ù… / 80 Ùƒ" />
        <div class="helper-text">Ø¹Ù„Ø´Ø§Ù† Ù†Ø³Ø§Ø¹Ø¯Ùƒ Ù†Ø®ØªØ§Ø± Ø£Ù†Ø³Ø¨ Ù…Ù‚Ø§Ø³ Ù„ÙŠÙƒÙŠ â¤ï¸</div>
      </div>

      <button type="submit" class="btn-primary" id="submitBtn">
        ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨
      </button>
    </form>
  </section>
</main>

<script>
  // ===== Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ø§Ù…Ø© =====
  const CART_KEY = "tefa_cart"; // Ù†ÙØ³ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰
  const SCRIPT_URL =
    "https://script.google.com/macros/s/AKfycbwPgm3Ez315GP5_E4SyM-NOjId3Whah4tdrXCRCHF1wYlk_CVwEgs4kd8WHCpJ50ggpiw/exec";

  let cartItems = [];

  // Ø­Ø³Ø¨Ø© Ø§Ù„Ø´Ø­Ù†
  function calculateShipping(governorate) {
    if (!governorate) return 0;

    const special120 = [
      "Ø´Ø±Ù… Ø§Ù„Ø´ÙŠØ®",
      "Ø§Ù„ØºØ±Ø¯Ù‚Ø©",
      "Ù…Ø±Ø³Ù‰ Ù…Ø·Ø±ÙˆØ­",
      "Ø´Ù…Ø§Ù„ Ø³ÙŠÙ†Ø§Ø¡",
      "Ø¬Ù†ÙˆØ¨ Ø³ÙŠÙ†Ø§Ø¡",
      "Ø§Ù„ÙˆØ§Ø¯ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯"
    ];

    if (governorate === "Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©" || governorate === "Ø§Ù„Ø¬ÙŠØ²Ø©") return 60;
    if (special120.includes(governorate)) return 120;
    return 70; // Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª
  }

  function loadCart() {
    try {
      const raw = localStorage.getItem(CART_KEY);
      if (!raw) return [];
      const parsed = JSON.parse(raw);
      return Array.isArray(parsed) ? parsed : [];
    } catch (e) {
      console.error("Error parsing cart", e);
      return [];
    }
  }

  function saveCart() {
    localStorage.setItem(CART_KEY, JSON.stringify(cartItems));
  }

  function renderCart() {
    const container = document.getElementById("cartItemsContainer");
    const badge = document.getElementById("cartCount");

    if (!cartItems.length) {
      container.innerHTML =
        '<div class="cart-items-empty">Ø§Ù„Ø³Ù„Ø© Ù„Ø³Ù‡ ÙØ§Ø¶ÙŠØ©ØŒ Ø§Ø±Ø¬Ø¹ÙŠ Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ÙˆØ§Ø®ØªØ§Ø±ÙŠ Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„Ø§Øª Ø§Ù„Ù„ÙŠ Ø¹Ø§ÙŠØ²Ø§Ù‡Ø§ ğŸ’–</div>';
      badge.textContent = "0";
      updateSummary();
      return;
    }

    badge.textContent = cartItems.reduce((sum, i) => sum + (i.quantity || 1), 0);

    container.innerHTML = "";
    cartItems.forEach((item, index) => {
      const div = document.createElement("div");
      div.className = "cart-item";

      const left = document.createElement("div");
      left.style.flex = "1";

      const title = document.createElement("div");
      title.className = "cart-item-title";
      title.textContent = item.name || "Ù…Ù†ØªØ¬ Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…";

      const meta = document.createElement("div");
      meta.className = "cart-item-meta";
      const colorText = item.colorName ? `Ù„ÙˆÙ†: ${item.colorName}` : "";
      const qtyText = `Ø§Ù„ÙƒÙ…ÙŠØ©: ${item.quantity || 1}`;
      meta.textContent = [colorText, qtyText].filter(Boolean).join(" | ");

      const removeBtn = document.createElement("button");
      removeBtn.className = "remove-btn";
      removeBtn.textContent = "Ø­Ø°Ù Ù…Ù† Ø§Ù„Ø³Ù„Ø©";
      removeBtn.onclick = () => {
        cartItems.splice(index, 1);
        saveCart();
        renderCart();
      };

      left.appendChild(title);
      left.appendChild(meta);
      left.appendChild(removeBtn);

      const right = document.createElement("div");
      const price = document.createElement("div");
      price.className = "cart-item-price";
      price.textContent = (item.totalPrice || item.price || 0) + " Ø¬";

      right.appendChild(price);

      div.appendChild(left);
      div.appendChild(right);
      container.appendChild(div);
    });

    updateSummary();
  }

  function updateSummary() {
    const productsTotal = cartItems.reduce(
      (sum, item) => sum + (item.totalPrice || item.price || 0),
      0
    );

    const governorate = document.getElementById("governorate").value;
    const shipping = calculateShipping(governorate);
    const grand = productsTotal + shipping;

    document.getElementById("productsTotalText").textContent =
      productsTotal + " Ø¬";
    document.getElementById("shippingText").textContent = shipping + " Ø¬";
    document.getElementById("grandTotalText").textContent = grand + " Ø¬";
  }

  document
    .getElementById("governorate")
    .addEventListener("change", updateSummary);

  // Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
  window.addEventListener("DOMContentLoaded", () => {
    cartItems = loadCart();
    renderCart();
  });

  // ===== Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ Google Sheet =====
  document
    .getElementById("orderForm")
    .addEventListener("submit", async function (e) {
      e.preventDefault();

      if (!cartItems.length) {
        alert("Ø§Ù„Ø³Ù„Ø© ÙØ§Ø¶ÙŠØ©ØŒ Ø§Ø®ØªØ§Ø±ÙŠ Ù…ÙˆØ¯ÙŠÙ„ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù‚Ø¨Ù„ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ ğŸŒ¸");
        return;
      }

      const name = document.getElementById("name").value.trim();
      const phone = document.getElementById("phone").value.trim();
      const governorate = document.getElementById("governorate").value;
      const address = document.getElementById("address").value.trim();
      const notes = document.getElementById("notes").value.trim();
      const weight = document.getElementById("weight").value.trim();

      if (!name || !phone || !governorate || !address) {
        alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø§ÙƒÙ…Ù„ÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ø£ÙˆÙ„Ø§Ù‹ â­");
        return;
      }

      const productsTotal = cartItems.reduce(
        (sum, item) => sum + (item.totalPrice || item.price || 0),
        0
      );
      const shipping = calculateShipping(governorate);
      const grandTotal = productsTotal + shipping;

      // ÙˆØµÙ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„ + Ø§Ù„Ù„ÙˆÙ† + Ø§Ù„ÙƒÙ…ÙŠØ©
      const productsDescription = cartItems
        .map((item) => {
          const color = item.colorName ? ` - Ù„ÙˆÙ†: ${item.colorName}` : "";
          const qty = ` - Ø¹Ø¯Ø¯: ${item.quantity || 1}`;
          return (item.name || "Ù…Ù†ØªØ¬") + color + qty;
        })
        .join(" | ");

      const payload = {
        name: name,
        phone: phone,
        governorate: governorate,
        address:
          address +
          (weight ? ` | (${weight})` : "") +
          (notes ? ` | Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${notes}` : ""),
        products: productsDescription,
        total: grandTotal
      };

      const submitBtn = document.getElementById("submitBtn");
      submitBtn.disabled = true;
      submitBtn.textContent = "Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ ...";

      try {
        const response = await fetch(SCRIPT_URL, {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(payload)
        });

        if (!response.ok) {
          throw new Error("Bad status: " + response.status);
        }

        const data = await response.json().catch(() => ({}));

        if (data.result !== "success") {
          throw new Error("Sheet error");
        }

        alert("ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­ ğŸ’— Ù‡Ù†ÙƒÙ„Ù…Ùƒ Ù„ØªØ£ÙƒÙŠØ¯Ù‡ ÙÙŠ Ø£Ø³Ø±Ø¹ ÙˆÙ‚Øª.");

        // ÙØ¶ÙŠ Ø§Ù„Ø³Ù„Ø© Ø¨Ø¹Ø¯ Ù†Ø¬Ø§Ø­ Ø§Ù„Ø­ÙØ¸
        cartItems = [];
        saveCart();
        renderCart();

        // Ø±Ø¬ÙˆØ¹ Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        window.location.href = "index.html";
      } catch (err) {
        console.error(err);
        alert(
          "ÙÙŠ Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª Ø£Ùˆ Google Sheet. Ù„Ùˆ Ø³Ù…Ø­ØªÙŠ ÙƒÙ„Ù…ÙŠÙ†Ø§ ÙˆØ§ØªØ³Ø§Ø¨ Ù„ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨Ùƒ."
        );
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = "ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨";
      }
    });
</script>
</body>
</html>